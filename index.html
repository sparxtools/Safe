<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord Cam Capture</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; text-align: center; background: #36393f; color: white; padding: 20px; }
        video { width: 100%; max-width: 400px; border-radius: 8px; border: 2px solid #5865F2; }
        button { background: #5865F2; color: white; border: none; padding: 15px 30px; border-radius: 5px; font-weight: bold; cursor: pointer; margin-top: 20px; }
        #status { margin-top: 15px; font-size: 0.9em; color: #b9bbbe; }
    </style>
</head>
<body>

    <h2>Discord Webhook Cam</h2>
    <video id="v" autoplay playsinline></video>
    <br>
    <button id="snap">SEND TO DISCORD</button>
    <p id="status">Waiting for camera...</p>
    <canvas id="c" style="display:none;"></canvas>

    <script>
        const v = document.getElementById('v');
        const c = document.getElementById('c');
        const btn = document.getElementById('snap');
        const status = document.getElementById('status');
        
        // YOUR WEBHOOK URL
        const HOOK = "https://discord.com/api/webhooks/1474021723002372260/IBeFoSemz3OCVD99-CJk8mfZKwxroqDkhmmd-39hRn5tunfR49zcvYJGlbAdgxLZ1HzF";

        // Start Camera
        navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } })
            .then(stream => { v.srcObject = stream; status.innerText = "Camera Active"; })
            .catch(err => { status.innerText = "Camera Error: " + err.message; });

        btn.onclick = () => {
            status.innerText = "Capturing...";
            c.width = v.videoWidth;
            c.height = v.videoHeight;
            c.getContext('2d').drawImage(v, 0, 0);

            c.toBlob(blob => {
                const formData = new FormData();
                // Discord expects the file under the 'file' or 'file1' field
                formData.append('file', blob, 'capture.jpg');
                formData.append('payload_json', JSON.stringify({ content: "üì∏ New photo captured from browser!" }));

                status.innerText = "Uploading to Discord...";

                fetch(HOOK, { method: 'POST', body: formData })
                .then(res => {
                    if(res.ok) status.innerText = "‚úÖ Posted to Discord!";
                    else status.innerText = "‚ùå Error: " + res.status;
                })
                .catch(e => {
                    status.innerText = "‚ùå Network Error (Likely CORS)";
                    console.error(e);
                });
            }, 'image/jpeg', 0.8);
        };
    </script>
</body>
</html>
